const productos= [
    {
        "id": "zapato01",
        "titulo": "Nike Sparta",
        "imagen": "./imagenes/imagenscategorias/zapato1.png",
        "categoria": {
            "marca": "Nike",
            "deporte": "Fútbol",
            "union": "Nike",
            "id": "calzado",
            "uni":"Futbol-nike2"
            
            
        },
        "precio": 90
    },

    {
        "id": "zapato02",
        "titulo": "Nike Clasicos",
        "imagen": "./imagenes/imagenscategorias/zapato2.png",
        "categoria": {
            "marca": "Nike",
            "deporte": "Fútbol",
            "union": "Nike",
            "id": "calzado",
             "uni":"Futbol-nike2"
        },
        "precio": 110
    },

  

  

    {
        "id": "zapato03",
        "titulo": "Adidas copa",
        "imagen": "./imagenes/imagenscategorias/zapato5.png",
        "categoria": {
            "marca": "Adidas",
            "deporte": "Fútbol",
            "union": "Adidas",
            "id": "calzado",
             "uni":"Futbol-adidas2"
        },
        "precio": 100
    },

    {
        "id": "zapato04",
        "titulo": "Adidas F50",
        "imagen": "./imagenes/imagenscategorias/futboladidas1.png",
        "categoria": {
            "marca": "Adidas",
            "deporte": "Fútbol",
            "union": "Adidas",
            "id": "calzado",
              "uni":"Futbol-adidas2"
        },
        "precio": 100
    },
   

    {
        "id": "zapato05",
        "titulo": "Puma AIR 99",
        "imagen": "./imagenes/imagenscategorias/futbolpuma1.png",
        "categoria": {
            "marca": "Puma",
            "deporte": "Fútbol",
            "union": "Puma",
            "id": "calzado",
              "uni":"Futbol-puma2"
        },
        "precio": 100
    },
    

    {
        "id": "zapato06",
        "titulo": "Puma Clasicos",
        "imagen": "./imagenes/imagenscategorias/futbolpuma2.png",
        "categoria": {
            "marca": "Puma",
            "deporte": "Fútbol",
            "union": "Puma",
            "id": "calzado",
                "uni":"Futbol-puma2"
        },
        "precio": 100
    },


    
    {
        "id": "zapato07",
        "titulo": "Nike Blazer",
        "imagen": "./imagenes/imagenscategorias/beibolnike3.png",
        "categoria": {
            "marca": "Nike",
            "deporte": "Béisbol",
            "union": "Nike",
            "id": "calzado",
             "uni":"Beisbol-nike2"
        },
        "precio": 100
    },

    {
        "id": "zapato08",
        "titulo": "Nike Clasicos",
        "imagen": "./imagenes/imagenscategorias/beisbolnike1.png",
        "categoria": {
            "marca": "Nike",
            "deporte": "Béisbol",
            "union": "Nike",
            "id": "calzado",
             "uni":"Beisbol-nike2"
        },
        "precio": 100
    },
 
    {
        "id": "zapato09",
        "titulo": "Adidas Ultimate",
        "imagen": "./imagenes/imagenscategorias/beiboladidas1.png",
        "categoria": {
            "marca": "Adidas",
            "deporte": "Béisbol",
            "union": "Adidas",
            "id": "calzado",
             "uni":"Beisbol-adidas2"
        },
        "precio": 100
    },

  

    {
        "id": "zapato11",
        "titulo": "Puma Fantasía",
        "imagen": "./imagenes/imagenscategorias/beisbolpuma2.png",
        "categoria": {
            "marca": "Puma",
            "deporte": "Béisbol",
            "union": "Puma",
            "id": "calzado",
             "uni":"Beisbol-Puma2"
        },
        "precio": 120
    },

    {
        "id": "zapato12",
        "titulo": "AIR Jordan",
        "imagen": "./imagenes/imagenscategorias/baloncestonike3.png",
        "categoria": {
            "marca": "Nike",
            "deporte": "Baloncesto",
            "union": "Nike",
            "id": "calzado",
             "uni":"Baloncesto-nike2"
        },
        "precio": 120
    },

    {
        "id": "zapato12",
        "titulo": "Travis 01",
        "imagen": "./imagenes/imagenscategorias/baloncestonike1.png",
        "categoria": {
            "marca": "Nike",
            "deporte": "Baloncesto",
            "union": "Nike",
            "id": "calzado",
             "uni":"Baloncesto-nike2"
        },
        "precio": 120
    },

    {
        "id": "zapato13",
        "titulo": "Adidas 360",
        "imagen": "./imagenes/imagenscategorias/baloncestoadidas1.png",
        "categoria": {
            "marca": "Adidas",
            "deporte": "Baloncesto",
            "union": "Adidas",
            "id": "calzado",
             "uni":"Baloncesto-adidas2"
        },
        "precio": 120
    },

    {
        "id": "zapato14",
        "titulo": "Puma 360",
        "imagen": "./imagenes/imagenscategorias/baloncestopuma1.png",
        "categoria": {
            "marca": "Puma",
            "deporte": "Baloncesto",
            "union": "Puma",
            "id": "calzado",
             "uni":"Baloncesto-Puma2"
        },
        "precio": 120
    },
    {
        "id": "zapato15",
        "titulo": "Puma Ultimate",
        "imagen": "./imagenes/imagenscategorias/baloncestopuma2.png",
        "categoria": {
            "marca": "Puma",
            "deporte": "Baloncesto",
            "union": "Puma",
            "id": "calzado",
             "uni":"Baloncesto-Puma2"
        },
        "precio": 120
    },
    {
        "id": "Balon01",
        "titulo": "Balón Nike Barcelona",
        "imagen": "./imagenes/balones/resized_150x150_nike2.jpg",
        "categoria": {
            "marca": "Nike",
            "deporte": "Futbol",
            "union2": "Nike",
            "unionDeporte":"Futbol-Nike",
            "id": "Accesorio"
        },
        "precio": 100
    },
    {
        "id": "Balon02",
        "titulo": "Balón Nike Premier",
        "imagen": "./imagenes/balones/resized_150x150_nike3.jpg",
        "categoria": {
            "marca": "Nike",
            "deporte": "Futbol",
            "union2": "Nike",
            "unionDeporte":"Futbol-Nike",
            "id": "Accesorio"
        },
        "precio": 110
    },
    {
        "id": "Balon03",
        "titulo": "Bólon Nike PSG",
      "imagen": "./imagenes/imagenscategorias/balonnike1.png",
        "categoria": {
            "marca": "Nike",
            "deporte": "Futbol",
            "union2": "Nike",
            "unionDeporte":"Futbol-Nike",
            "id": "Accesorio"
        },
        "precio": 120
    },
  
    
    {
        "id": "Balon06",
        "titulo": "Balón Puma La Liga 22",
        "imagen": "./imagenes/balones/resized_150x150_puma1.jpg",
        "categoria": {
            "marca": "Puma",
            "deporte": "Futbol",
            "union2": "Puma",
            "unionDeporte":"Futbol-Puma",
            "id": "Accesorio"
        },
        "precio": 100
    },
    {
        "id": "Balon07",
        "titulo": "Balón Puma La Liga 23",
        "imagen": "./imagenes/balones/resized_150x150_puma2.jpg",
        "categoria": {
            "marca": "Puma",
            "deporte": "Futbol",
            "union2": "Puma",
            "unionDeporte":"Futbol-Puma",
            "id": "Accesorio"
        },
        "precio": 110
    },
    {
        "id": "Balon08",
        "titulo": "Balón Puma La Liga 24",
        "imagen": "./imagenes/balones/resized_150x150_puma3.jpg",
        "categoria": {
            "marca": "Puma",
            "deporte": "Futbol",
            "union2": "Puma",
            "unionDeporte":"Futbol-Puma",
            "id": "Accesorio"
        },
        "precio": 120
    },
   
    {
        "id": "Balon10",
        "titulo": "Balón Mundial 2022",
        "imagen": "./imagenes/balones/resized_150x150_adidas2.jpg",
        "categoria": {
            "marca": "Adidas",
            "deporte": "Futbol",
            "union2": "Adidas",
            "unionDeporte":"Futbol-Adidas",
            "id": "Accesorio"
        },
        "precio": 140
    },
    {
        "id": "Balon11",
        "titulo": "Balón Champions league 2022",
        "imagen": "./imagenes/balones/resized_150x150_adidas3.jpg",
        "categoria": {
            "marca": "Adidas",
            "deporte": "Futbol",
            "union2": "Adidas",
            "unionDeporte":"Futbol-Adidas",
            "id": "Accesorio"
        },
        "precio": 150
    },
    {
        "id": "Balon12",
        "titulo": "Balón Mundial 2010",
        "imagen": "./imagenes/balones/resized_150x150_adidas5.jpg",
        "categoria": {
            "marca": "Adidas",
            "deporte": "Futbol",
            "union2": "Adidas",
            "unionDeporte":"Futbol-Adidas",
            "id": "Accesorio"
        },
        "precio": 130
    },
    {
        "id": "Balon13",
        "titulo": "Balón Mundial 2014",
        "imagen": "./imagenes/balones/resized_150x150_adidas4.jpg",
        "categoria": {
            "marca": "Adidas",
            "deporte": "Futbol",
            "union2": "Adidas",
            "unionDeporte":"Futbol-Adidas",
            "id": "Accesorio"
        },
        "precio": 120
    },

    {
        "id": "Balon14",
        "titulo": "Balón Baloncesto Adidas",
        "imagen": "./imagenes/imagenscategorias/balonbaloncestoadidas2.png",
        "categoria": {
            "marca": "Adidas",
            "deporte": "Baloncesto",
            "union2": "Adidas",
            "unionDeporte":"Baloncesto-Adidas",
            "id": "Accesorio"
        },
        "precio": 100
    },

    {
        "id": "Balon15",
        "titulo": "Balón Baloncesto Puma",
        "imagen": "./imagenes/imagenscategorias/balonbaloncestopuma1.png",
        "categoria": {
            "marca": "Puma",
            "deporte": "Baloncesto",
            "union2": "Puma",
            "unionDeporte":"Baloncesto-Puma",
            "id": "Accesorio"
        },
        "precio": 110
    },
    {
        "id": "Balon16",
        "titulo": "Balón Baloncesto Nike",
  "imagen": "./imagenes/imagenscategorias/balonbaloncesto1.png",
        "categoria": {
            "marca": "Nike",
            "deporte": "Baloncesto",
            "union2": "Nike",
            "unionDeporte":"Baloncesto-Nike",
            "id": "Accesorio"
        },
        "precio": 100
    },
    
    {
        "id": "gorra1",
        "titulo": "Gorra Béisbol Adidas Negra",
        "imagen": "./imagenes/imagenscategorias/gorraadidas1.png",
        "categoria": {
            "marca": "Adidas",
            "deporte": "Beisbol",
            "union2": "Nike",
            "unionDeporte":"Beisbol-Adidas",
            "id": "Accesorio"
        },
        "precio": 17
    },
     
    {
        "id": "gorra2",
        "titulo": "Gorra Béisbol Adidas Azul",
        "imagen": "./imagenes/imagenscategorias/gorraadidas2.png",
        "categoria": {
            "marca": "Adidas",
            "deporte": "Beisbol",
            "union2": "Nike",
            "unionDeporte":"Beisbol-Adidas",
            "id": "Accesorio"
        },
        "precio": 17
    },

    {
        "id": "gorra3",
        "titulo": "Gorra Béisbol Nike Negra",
        "imagen": "./imagenes/imagenscategorias/gorranike1.png",
        "categoria": {
            "marca": "Nike",
            "deporte": "Beisbol",
            "union2": "Nike",
            "unionDeporte":"Beisbol-Nike",
            "id": "Accesorio"
        },
        "precio": 1700
    },
    
    {
        "id": "gorra4",
        "titulo": "Gorra Béisbol Nike Blanca",
        "imagen": "./imagenes/imagenscategorias/gorranike2.png",
        "categoria": {
            "marca": "Nike",
            "deporte": "Beisbol",
            "union2": "Nike",
            "unionDeporte":"Beisbol-Nike",
            "id": "Accesorio"
        },
        "precio": 17
    },

    {
        "id": "gorra5",
        "titulo": "Gorra Béisbol Puma Blanca",
        "imagen": "./imagenes/imagenscategorias/gorrapuma1.png",
        "categoria": {
            "marca": "Puma",
            "deporte": "Beisbol",
            "union2": "Puma",
            "unionDeporte":"Beisbol-Puma",
            "id": "Accesorio"
        },
        "precio": 17
    },

    {
        "id": "gorra6",
        "titulo": "Gorra Béisbol Puma Blanca 2",
        "imagen": "./imagenes/imagenscategorias/gorrapuma1.png",
        "categoria": {
            "marca": "Puma",
            "deporte": "Beisbol",
            "union2": "Puma",
            "unionDeporte":"Beisbol-Puma",
            "id": "Accesorio"
        },
        "precio": 17
    },
    
]

const ContenedorProductos = document.querySelector("#Contenedor-productos");
const EnlacesCategorias = document.querySelectorAll(".categoria");
const tituloPrincipal = document.querySelector("#titulo-principal");
let botonesAgregar = document.querySelectorAll(".producto-agregar");
const numerito = document.querySelector("#numerito");
const contenedorP2 = document.querySelector("#Contenedor-productos2");
let botonesMuestras = document.querySelectorAll(".Vista");

function CargarProductos(productos) {
   // Limpia el contenedor antes de agregar nuevos productos
   ContenedorProductos.innerHTML = "";

    productos.forEach(producto => {
        const div = document.createElement("div");
        div.classList.add("car");
        div.innerHTML = `
            <div class="fotosproductos">
                        <a href="seleccionarprod.html" class="vista" id="${producto.id}" style="text-decoration: none; color: black;">Ver Producto</a>

              <img src="${producto.imagen}" alt="">
            </div>
            <div class="divtexto">
                <h2>${producto.titulo}</h2>
                <p>$${producto.precio}</p>
                <button class="producto-agregar" id="${producto.id}">
                    <ion-icon name="cart-outline" class="icono2"></ion-icon>
                </button>
            </div>
        `;
        ContenedorProductos.append(div);
    });

    // Actualizar botones de agregar al carrito
    actualizarBotonesAgregar();

    // Añadir event listeners a los enlaces de la clase .vista
    actualizarBotonesVista();
}

CargarProductos(productos);

EnlacesCategorias.forEach(boton => {
    boton.addEventListener("click", (e) => {
        e.preventDefault();
        const productosBoton = productos.filter(producto => producto.categoria.id === e.currentTarget.id);
        CargarProductos(productosBoton);
    });
});

function actualizarBotonesAgregar() {
    botonesAgregar = document.querySelectorAll(".producto-agregar");

    botonesAgregar.forEach(boton => {
        boton.addEventListener("click", agregarAlCarrito);
    });
}

let productosEnCarrito = [];

let productosEnCarritoLS = localStorage.getItem("productos-en-carrito");

if (productosEnCarritoLS) {
    productosEnCarrito = JSON.parse(productosEnCarritoLS);
    actualizarNumerito();
}

function agregarAlCarrito(e) {
    const idBoton = e.currentTarget.id;
    const productoAgregado = productos.find(producto => producto.id === idBoton);

    if (productosEnCarrito.some(producto => producto.id === idBoton)) {
        const index = productosEnCarrito.findIndex(producto => producto.id === idBoton);
        productosEnCarrito[index].cantidad++;
    } else {
        productoAgregado.cantidad = 1;
        productosEnCarrito.push(productoAgregado);
    }
    console.log(productosEnCarrito);

    actualizarNumerito();

    localStorage.setItem("productos-en-carrito", JSON.stringify(productosEnCarrito));

    Toastify({
        text: "Producto Agregado",
        duration: 3000,
        close: true,
        gravity: "top",
        position: "right",
        stopOnFocus: true,
        style: {
            background: "#233588",
            color: "#fab50f",
            borderRadius: "2rem",
            textTransform: "uppercase",
            fontSize: ".75rem"
        },
        offset: {
            x: '1.5rem',
            y: '1.5rem'
        },
        onClick: function() {}
    }).showToast();
}

function actualizarNumerito() {
    let nuevoNumerito = productosEnCarrito.reduce((acc, producto) => acc + producto.cantidad, 0);
    numerito.innerText = nuevoNumerito;
}

const EnlacesMarcas = document.querySelectorAll(".marca1");

EnlacesMarcas.forEach(boton => {
    boton.addEventListener("click", (e) => {
        e.preventDefault();
        const marcaSeleccionada = e.currentTarget.id;
        const productosMarca = productos.filter(producto => producto.categoria.union === marcaSeleccionada);
        CargarProductos(productosMarca);
    });
});

const EnlacesMarcas2 = document.querySelectorAll(".marca");

EnlacesMarcas2.forEach(boton => {
    boton.addEventListener("click", (e) => {
        e.preventDefault();
        const marcaSeleccionada = e.currentTarget.id;
        const productosMarca = productos.filter(producto => producto.categoria.union2 === marcaSeleccionada);
        CargarProductos(productosMarca);
    });
});

const EnlacesDeporte = document.querySelectorAll(".deportes");

EnlacesDeporte.forEach(boton => {
    boton.addEventListener("click", (e) => {
        e.preventDefault();
        const Deporteselecionado = e.currentTarget.id;
        const productosMarca = productos.filter(producto => producto.categoria.unionDeporte === Deporteselecionado);
        CargarProductos(productosMarca);
    });
});

const EnlacesDeporte2 = document.querySelectorAll(".deporte");

EnlacesDeporte2.forEach(boton => {
    boton.addEventListener("click", (e) => {
        e.preventDefault();
        const Deporteselecionado = e.currentTarget.id;
        const productosMarca = productos.filter(producto => producto.categoria.uni === Deporteselecionado);
        CargarProductos(productosMarca);
    });
});

function saveIdToLocalStorage(id) {
    localStorage.removeItem('viewedProducts');
    let viewedProducts = JSON.parse(localStorage.getItem('viewedProducts')) || [];
    let product = productos.find(producto => producto.id === id);

    if (product) {
        viewedProducts.push(product);
        localStorage.setItem('viewedProducts', JSON.stringify(viewedProducts));
        console.log(viewedProducts);
    } else {
        console.log('Producto no encontrado');
    }
}

function actualizarBotonesVista() {
    document.querySelectorAll('.vista').forEach(item => {
        item.addEventListener('click', function(event) {
            let productId = this.getAttribute('id');
            saveIdToLocalStorage(productId);
        });
    });
}

// Añadir event listeners inicialmente
actualizarBotonesVista();
